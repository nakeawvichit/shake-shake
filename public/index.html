<!doctype html>
<html>

<head>
  <title>Shake</title>
  <style>
    body,
    html {
      height: 100%;
      margin: 0;
    }

    .hero-image {
      background-image: linear-gradient(rgba(0, 0, 0, 0.5), rgba(0, 0, 0, 0.5)), url("/public/bg.jpg");
      height: 100%;
      background-position: center;
      background-repeat: no-repeat;
      background-size: cover;
      position: relative;
    }

    .hero-text {
      text-align: center;
      position: absolute;
      top: 50%;
      left: 50%;
      transform: translate(-50%, -50%);
      color: white;
    }

    .hero-text button {
      border: none;
      outline: 0;
      display: inline-block;
      padding: 10px 25px;
      color: black;
      background-color: #ddd;
      text-align: center;
      cursor: pointer;
    }

    .hero-text button:hover {
      background-color: #555;
      color: white;
    }

    #myProgress {
      width: 100%;
      background-color: #ddd;
    }

    #myBar {
      width: 1%;
      height: 30px;
      background-color: #4CAF50;
    }
  </style>
</head>

<body>
  <div class="hero-image">
    <div class="hero-text">
      <h1 style="font-size:50px">หมอนร๊</h1>
      <p>ทำนายดวงชะตา ถถถถถถถถถ</p>
      <p id="text-paper">ได้โปรดเขย่าเพื่อส่งพลังข้าพเจ้าให้เต็มหลอด</p>
      <div id="myProgress">
        <div id="myBar"></div>
      </div>
    </div>
  </div>
  <script src="/libs/shake.js/shake.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/socket.io/2.2.0/socket.io.js"></script>
  <script src="/libs/jquery/dist/jquery.min.js"></script>
  <script>

    $(function () {
      var socket = io();
      var shakeEvent = new Shake({ threshold: 10, timeout: 500 });
      shakeEvent.start();
      var width = 1;
      window.addEventListener('shake', function () {
        var elem = document.getElementById("myBar");
        if (width >= 100) {
          socket.emit('event', 'Hello');
          width = 1;
          elem.style.width = width + '%';
        } else {
          width = width + 5;
          elem.style.width = width + '%';
        }
      }, false);

      //stop listening
      function stopShake() {
        shakeEvent.stop();
      }

      //check if shake is supported or not.
      if (!("ondevicemotion" in window)) {
        alert("Not Supported");
      }

      socket.on('connect', function () {
        console.log('connected');
        socket.emit('status', 'Shake server online');

      });
      socket.on('disconnect', function () {
        console.log('disconnected')
      });
      socket.on('status', function (msg) {
        console.log(msg);
        // $("#text-paper").text(msg);
      });
      socket.on('event', function (msg) {
        console.log(msg);
        // $("#text-paper").text(msg);
      });



    });


  </script>
</body>

</html>